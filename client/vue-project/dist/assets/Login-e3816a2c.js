import{d as U,u as j,r as F,a as m,E as L,o as k,c as T,b as r,e as t,w as s,f as _,g as z,h,i as J,j as K,k as R,l as S,s as $,m as M,n as P,p as Q,v as A,q as D,t as G,x as H,_ as W}from"./index-27b28a64.js";import{E as X,a as Y}from"./el-input-1fcf1053.js";import{E as Z}from"./el-checkbox-77d8fb6b.js";import{E as ee,s as oe}from"./request-c1c2d5d0.js";const te=c=>(G("data-v-4fe0fa89"),c=c(),H(),c),se={class:"login-wrapper"},ae={class:"ms-login"},le=te(()=>r("div",{class:"ms-title"},"后台管理系统",-1)),ne={class:"jizhu"},re={class:"btn-wrapper"},ce=U({__name:"Login",setup(c){const V=j(),E=K(),w=R(),b=localStorage.getItem("account")||"",x=localStorage.getItem("password")||"";let u=localStorage.getItem("takeNotes")||!0;u&&(u=JSON.parse(u));const a=F({account:b,password:x}),d=m(!1),p=m(u),f=m(!1),N={account:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},g=m(),q=n=>Object.keys(n).reduce((e,o)=>(o!=="redirect"&&(e[o]=n[o]),e),{}),B=()=>{d.value=!d.value},y=n=>{n&&(f.value=!0,n.validate(e=>{if(e)oe({url:"/api/token",method:"post",data:{...a,type:"101"}}).then(o=>{if(o.code===0){S.success("登录成功"),p.value?(localStorage.setItem("account",a.account),localStorage.setItem("password",a.password)):(localStorage.removeItem("account"),localStorage.removeItem("password")),localStorage.setItem("takeNotes",JSON.stringify(p.value)),o=o.data,$(o.token),V.token=o.token;const i=w.query.redirect||"";E.push({path:i,query:q(w.query)})}else S.error(o.message)}).finally(()=>{f.value=!1});else return!1}))};return(n,e)=>{const o=M,i=ee,v=X,I=L,C=Z,O=Y;return k(),T("div",se,[r("div",ae,[le,t(O,{rules:N,ref_key:"login",ref:g,model:a,class:"ms-content"},{default:s(()=>[t(v,{prop:"account"},{default:s(()=>[t(i,{modelValue:a.account,"onUpdate:modelValue":e[0]||(e[0]=l=>a.account=l),placeholder:"请输入用户名"},{prepend:s(()=>[t(o,{icon:_(P)},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),t(v,{prop:"password"},{default:s(()=>[t(i,{onKeyup:e[1]||(e[1]=z(l=>y(g.value),["enter"])),type:d.value?"text":"password",modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=l=>a.password=l),placeholder:"请输入密码"},{prepend:s(()=>[t(o,{icon:_(Q)},null,8,["icon"])]),_:1},8,["type","modelValue"]),r("span",{class:"show-pwd",onClick:B},[d.value?(k(),h(I,{key:0},{default:s(()=>[t(_(A))]),_:1})):(k(),h(I,{key:1},{default:s(()=>[t(_(D))]),_:1}))])]),_:1}),t(v,null,{default:s(()=>[r("div",ne,[t(C,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=l=>p.value=l),label:"记住密码",size:"large"},null,8,["modelValue"])])]),_:1}),r("div",re,[t(o,{type:"primary",onClick:e[4]||(e[4]=l=>y(g.value)),loading:f.value},{default:s(()=>[J("登录")]),_:1},8,["loading"])])]),_:1},8,["model"])])])}}});const me=W(ce,[["__scopeId","data-v-4fe0fa89"]]);export{me as default};
